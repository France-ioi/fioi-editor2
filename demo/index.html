<!DOCTYPE html>
<title>Editor component testing</title>

<script type="text/javascript" src="../bower_components/requirejs/require.js"></script>

<script type="text/javascript">
requirejs.config({
  "baseUrl": '..',
  "paths": {
    "angular": "bower_components/angular/angular.min",
    "angular-ui-ace": "bower_components/angular-ui-ace/ui-ace.min",
    "es5-shim": "bower_components/es5-shim/es5-shim.min",
    "lodash": "bower_components/lodash/lodash.min",
    "ace": "bower_components/ace-builds/src-min-noconflict/ace",
    "fioi-editor2": "dist/fioi-editor2"
  },
  "shim": {
    "angular": {"exports": "angular"},
    "angular-ui-ace": {"deps": ["angular", "ace"]}
  }
});
require(['angular', 'es5-shim', 'fioi-editor2'], function (angular) {
  angular.element(document).ready(function () {

    var sampleText = "#include \"lib.h\"\nconst int LARGEUR_MAX = 1000000;\nint destinationBille[LARGEUR_MAX+1];\nint main()\n{\n  for(int iPos = nbMarches() - 2; iPos >= 0; --iPos)\n  {\n    if(hauteur(iPos) < hauteur(iPos+1))\n      destinationBille[iPos] = iPos;\n    else\n      destinationBille[iPos] = destinationBille[iPos+1];\n  }\n  for(int iBille = 0; iBille < nbLancers(); ++iBille)\n  {\n    int posBille = marcheLancer(iBille);\n    positionFinale(destinationBille[posBille]);\n  }\n  return 0;\n}";

    var app = angular.module('main', ['fioi-editor2']);
    var sourceLanguages = [
      {id: 'c', label: "C", ext: 'c', ace: {mode: 'c_cpp'}},
      {id: 'cpp', label: "C++", ext: 'cpp', ace: {mode: 'c_cpp'}},
      {id: 'pascal', label: "Pascal", ext: 'pas', ace: {mode: 'pascal'}},
      {id: 'ocaml', label: "OCaml", ext: 'ml', ace: {mode: 'ocaml'}},
      {id: 'java', label: "Java", ext: 'java', ace: {mode: 'java'}},
      {id: 'javascool', label: "JavaScool", ext: 'jvs', ace: {mode: 'java'}},
      {id: 'python2', label: "Python", ext: 'py', ace: {mode: 'python'}}
    ];
    app.run(['FioiEditor2Tabsets', function (tabsets) {
      var sources = tabsets.add('sources', {mode: 'sources', languages: sourceLanguages, titlePrefix: 'Code'});
      var code1 = sources.addTab({title: 'Code1', language: 'cpp'});
      var buffer = code1.addBuffer(sampleText);
    }]);
    app.controller('Main', ['$scope', function ($scope) {
      var controller = this;
      $scope.sourcesEditor = {
        tabset: 'sources',
        onInit: function (api) {
          controller.editorApi = api;
        }
      };
      $scope.testEditorApi = function () {
        this.editorApi.placeholder();
      };
    }]);
    angular.bootstrap(document, ['main'], {strictDi: true});
  });
});
</script>

<style type="text/css">
*[ng-cloak] { display: none !important; }
body { background-color: #eee; }
.fioi-editor2 { background-color: #fff; }
</style>

<div ng-cloak ng-controller="Main">
  <div fioi-editor2="sourcesEditor"></div>
  <button type="button" ng-click="testEditorApi()">test Editor API</button>
</div>
