<!DOCTYPE html>
<title>Editor component testing</title>

<script type="text/javascript" src="../bower_components/requirejs/require.js"></script>

<script type="text/javascript">
requirejs.config({
  "baseUrl": '..',
  "paths": {
    "angular": "bower_components/angular/angular",
    "es5-shim": "bower_components/es5-shim/es5-shim",
    "lodash": "bower_components/lodash/lodash.min",
    "fioi-editor2": "dist/fioi-editor2"
  },
  "shim": {
    "angular": {"exports": "angular"}
  }
});
require(['angular', 'es5-shim', 'fioi-editor2'], function (angular) {
  angular.element(document).ready(function () {

    var sampleText = "#include \"lib.h\"\nconst int LARGEUR_MAX = 1000000;\nint destinationBille[LARGEUR_MAX+1];\nint main()\n{\n  for(int iPos = nbMarches() - 2; iPos &gt;= 0; --iPos)\n  {\n    if(hauteur(iPos) &lt; hauteur(iPos+1))\n      destinationBille[iPos] = iPos;\n    else\n      destinationBille[iPos] = destinationBille[iPos+1];\n  }\n  for(int iBille = 0; iBille &lt; nbLancers(); ++iBille)\n  {\n    int posBille = marcheLancer(iBille);\n    positionFinale(destinationBille[posBille]);\n  }\n  return 0;\n}";

    var app = angular.module('main', ['fioi-editor2']);
    var sourceLanguages = [
      {name: "C", ext: 'c'},
      {name: "C++", ext: 'cpp'},
      {name: "Pascal", ext: 'pas'},
      {name: "OCaml", ext: 'ml'},
      {name: "Java", ext: 'java'},
      {name: "JavaScool", ext: 'java'},
      {name: "Python", ext: 'py'}
    ];
    app.run(['FioiEditor2Tabsets', function (tabsets) {
      var sources = tabsets.add('sources', {mode: 'sources', languages: sourceLanguages, titlePrefix: 'Code'});
      var code1 = sources.addTab({title: 'Code1', language: 'C++'});
      var buffer = code1.addBuffer(sampleText);
    }]);
    app.controller('Main', ['$scope', function ($scope) {
      $scope.onEditorInit = function (api) {
        this.editorApi = api;
      };
      $scope.testEditorApi = function () {
        this.editorApi.placeholder();
      };
    }]);
    angular.bootstrap(document, ['main'], {strictDi: true});
  });
});
</script>

<style type="text/css">
*[ng-cloak] { display: none !important; }
body { background-color: #eee; }
.fioi-editor2 { background-color: #fff; }
</style>
<link rel="stylesheet" href="../css/style.css">

<div ng-cloak ng-controller="Main">
  <fioi-editor2 on-init="onEditorInit(api)" tabset="sources"></fioi-editor2>
  <button type="button" ng-click="testEditorApi()">test Editor API</button>
</div>
